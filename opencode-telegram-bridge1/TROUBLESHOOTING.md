â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘              ğŸ”§ å†²çªé—®é¢˜è§£å†³æŒ‡å—                               â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

## âš ï¸ é—®é¢˜åŸå› 

Telegram è¿”å› `409 Conflict` é”™è¯¯ï¼Œè¯´æ˜ï¼š
- **ä½ çš„ bot æ­£åœ¨å…¶ä»–åœ°æ–¹ä½¿ç”¨**
- æˆ– **Telegram æœåŠ¡å™¨ç«¯æœ‰æ®‹ç•™çš„ webhook è¿æ¥**

---

## âœ… è§£å†³æ–¹æ¡ˆï¼šä½¿ç”¨é‡å¯è„šæœ¬

æˆ‘å·²ç»åˆ›å»ºäº† `restart.sh`ï¼Œå®ƒä¼šè‡ªåŠ¨ï¼š
1. åˆ é™¤ Telegram webhook
2. ç­‰å¾…æ¸…ç†ç”Ÿæ•ˆ
3. åœæ­¢æœ¬åœ°æ‰€æœ‰ bot è¿›ç¨‹
4. æ¸…ç†å¹¶å¯åŠ¨ bot

---

## ğŸš€ ç«‹å³ä½¿ç”¨ï¼ˆ3 æ­¥éª¤ï¼‰

### ç¬¬ 1 æ­¥ï¼šæ¸…ç†å¹¶å¯åŠ¨

```bash
cd /path/to/opencode-telegram-bridge
./restart.sh
```

### ç¬¬ 2 æ­¥ï¼šæµ‹è¯•

åœ¨ Telegram ä¸­æœç´¢ `@your_bot_username`ï¼Œå‘é€ `/start`

---

## ğŸ¯ å¦‚æœè¿˜å†²çª...

### æ–¹æ¡ˆ Aï¼šç­‰å¾… 5-10 åˆ†é’Ÿ

Telegram æœåŠ¡å™¨çš„ webhook ç¼“å­˜å¯èƒ½éœ€è¦æ—¶é—´å¤±æ•ˆã€‚ç­‰å¾… 5-10 åˆ†é’Ÿåå†è¯•ã€‚

### æ–¹æ¡ˆ Bï¼šé‡æ–°åˆ›å»º Bot

å¦‚æœé—®é¢˜æŒç»­ï¼Œè¯´æ˜ token å·²åœ¨å…¶ä»–åœ°æ–¹ä½¿ç”¨ï¼š

1. åœ¨ Telegram ä¸­æœç´¢ `@BotFather`
2. å‘é€ `/mybots`
3. é€‰æ‹©ä½ çš„ bot
4. ç‚¹å‡» "API Token"
5. å¤åˆ¶**æ–°çš„** token
6. æ›´æ–° `.env` æ–‡ä»¶
7. è¿è¡Œ `./restart.sh`

### æ–¹æ¡ˆ Cï¼šæ£€æŸ¥æ˜¯å¦æœ‰å…¶ä»–ç¨‹åº

```bash
# æ£€æŸ¥æ˜¯å¦æœ‰å…¶ä»–ç¨‹åºåœ¨ä½¿ç”¨è¿™ä¸ª bot
ps aux | grep "python"
```

---

## ğŸ“‹ å®Œæ•´å¯åŠ¨æµç¨‹

```bash
# 1. ç¡®è®¤ OpenCode åœ¨è¿è¡Œ
lsof -i :4096

# 2. å¦‚æœæ²¡æœ‰ï¼Œå¯åŠ¨ OpenCode
opencode serve --port=4096 &

# 3. ä½¿ç”¨ restart.sh å¯åŠ¨ bot
cd /path/to/opencode-telegram-bridge
./restart.sh
```

---

## ğŸ” éªŒè¯çŠ¶æ€

### æ£€æŸ¥ Bot Token æ˜¯å¦æœ‰æ•ˆ

```bash
python3 verify_token.py
```

### æ£€æŸ¥ OpenCode æ˜¯å¦å¯è®¿é—®

```bash
curl http://localhost:4096/session
```

### æ£€æŸ¥ Bot æ˜¯å¦è¿è¡Œ

```bash
ps aux | grep "python3.*bot"
```

---

## âœ¨ æˆåŠŸæ ‡å¿—

Bot æ­£å¸¸è¿è¡Œæ—¶ï¼Œä½ ä¼šçœ‹åˆ°ï¼š

```
2026-02-01 ... - __main__ - INFO - Starting Telegram bot with polling...
2026-02-01 ... - __main__ - INFO - Received message from user: ä½ å¥½
2026-02-01 ... - __main__ - INFO - Creating new session for user ...
2026-02-01 ... - __main__ - INFO - Using session ses_xxx for user ...
2026-02-01 ... - __main__ - INFO - Sent response to user
```

**æ²¡æœ‰**è¿™äº›é”™è¯¯ï¼š
- âŒ `Conflict: terminated by other getUpdates request`
- âŒ `Unauthorized`

---

## ğŸ“ éœ€è¦å¸®åŠ©ï¼Ÿ

å¦‚æœé—®é¢˜æŒç»­ï¼š

1. **é‡æ–°åˆ›å»º Bot**ï¼ˆæ¨èï¼‰
   - åœ¨ @BotFather ä¸­å‘é€ `/mybots`
   - ç‚¹å‡»ä½ çš„ bot
   - é€‰æ‹© "Delete Bot"
   - é‡æ–°åˆ›å»º

2. **æŸ¥çœ‹å®Œæ•´æ–‡æ¡£**
   - `æœ€ç»ˆæŠ¥å‘Š.md`
   - `README.md`

---

## ğŸ‰ è§£å†³å

Bot æˆåŠŸå¯åŠ¨åï¼Œä½ å°±å¯ä»¥ï¼š

- âœ… åœ¨ Telegram ä¸­å‘é€æ¶ˆæ¯
- âœ… OpenCode è‡ªåŠ¨å¤„ç†
- âœ… æ”¶åˆ° AI å“åº”

---

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘  ç¥ä½ æˆåŠŸï¼ğŸ‰                                                  â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
